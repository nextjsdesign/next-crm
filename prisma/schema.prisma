generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

//
// ==========================
//        ENUMURI
// ==========================
//

enum Role {
  admin
  technician
  receptionist
}

//
// ==========================
//        MODELE
// ==========================
//

model User {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  name      String
  email     String   @unique
  password  String
  role      Role     @default(technician) // ğŸ¯ enum validat
  workHours String? // ex: "09:00-17:00"
  target    Int? // target lunar (lei)
  bonus     Int? // bonus curent
  createdAt DateTime @default(now())
  updatedAt DateTime? @updatedAt
  isActive Boolean @default(true)

  // ğŸ”— RelaÈ›ie: un user poate avea mai multe fiÈ™e
  devices Device[]
}

model Client {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  name      String
  phone     String?
  email     String?
  address   String?
  createdAt DateTime @default(now())

  // ğŸ”— un client poate avea mai multe dispozitive
  devices Device[]
}

model Settings {
  id          String   @id @default(auto()) @map("_id") @db.ObjectId
  companyName String
  email       String
  phone       String
  theme       String   @default("system")
  logoUrl     String?
  tabStyle    String   @default("classic")  // ğŸ‘ˆ nou
  updatedAt   DateTime @updatedAt
}

model Device {
  id String @id @default(auto()) @map("_id") @db.ObjectId

  // ğŸ”— RelaÈ›ii
  clientId String @db.ObjectId
  client   Client @relation(fields: [clientId], references: [id])

  userId String? @db.ObjectId
  user   User?   @relation(fields: [userId], references: [id])

  parentDeviceId String? @db.ObjectId // legÄƒturÄƒ cu fiÈ™a anterioarÄƒ

  // ğŸ§¾ Tip fiÈ™Äƒ & status
  sheetType String? // "NouÄƒ" / "GaranÈ›ie"
  status    String  @default("Primire")

  // ğŸ§© Detalii generale
  deviceType   String?
  brand        String?
  model        String?
  serialNumber String?

  // âš™ï¸ Probleme & descrieri
  problem     String?
  description String?
  accessories String?
  technician  String?

  // ğŸ’° PreÈ›uri & garanÈ›ii
  priceEstimate  Float?
  advance        Float?
  warranty       String? // "30 zile", "90 zile"
  priceConfirmed Boolean @default(false)

  // ğŸ§¾ InformaÈ›ii suplimentare
  liquidContact Boolean   @default(false)
  notes         String?
  deliveryDays  Int?
  deliveryDate  DateTime?

  // ğŸ§¾ RecepÈ›ie / stare esteticÄƒ
  receptionCondition String?
  receptionNotes     String?

  createdAt DateTime @default(now())
}
